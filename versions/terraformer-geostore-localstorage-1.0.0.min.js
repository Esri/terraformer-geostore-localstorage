!function(a,b){if("object"==typeof a.navigator){if(!a.Terraformer)throw new Error("Terraformer.GeoStore.LocalStorage requires the core Terraformer library. https://github.com/esri/Terraformer");if(!a.Terraformer.GeoStore)throw new Error("Terraformer.GeoStore.LocalStorage requires the Terraformer GeoStore library. https://github.com/esri/terraformer-geostore");a.Terraformer.GeoStore.LocalStorage=b(a.Terraformer).LocalStorage}}(this,function(){function a(){var a=arguments[0]||{};this._key=a.key||"_terraformer"}var b={};return a.prototype.add=function(a,b){if("FeatureCollection"===a.type)for(var c=0;c<a.features.length;c++)this.set(a.features[c]);else this.set(a);b&&b(null,a)},a.prototype.key=function(a){return this._key+"_"+a},a.prototype.remove=function(a,b){localStorage.removeItem(this.key(a)),b&&b(null,a)},a.prototype.get=function(a,b){b&&b(null,JSON.parse(localStorage.getItem(this.key(a))))},a.prototype.set=function(a){localStorage.setItem(this.key(a.id),JSON.stringify(a))},a.prototype.update=function(a,b){this.set(a),b&&b(null,a)},a.prototype.serialize=function(a){var b=[];for(var c in localStorage)c.match(this._key)&&b.push(JSON.parse(localStorage.getItem(c)));a&&a(null,JSON.stringify(b))},a.prototype.deserialize=function(a,b){for(var c=JSON.parse(a),d=c.length-1;d>=0;d--)this.set(c[d]);b&&b()},b.LocalStorage=a,b});